(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f920fa6c"],{"05bb":function(e,t,i){"use strict";i("6668")},"164e":function(e,t,i){"use strict";i.r(t);var a=i("4f37"),s=i("2859");for(var n in s)["default"].indexOf(n)<0&&function(e){i.d(t,e,(function(){return s[e]}))}(n);i("05bb");var o=i("0c7c"),l=Object(o["a"])(s["default"],a["a"],a["b"],!1,null,"50787d28",null);t["default"]=l.exports},"21ea":function(e,t,i){"use strict";var a=i("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;a(i("b775"));var s=a(i("1157")),n=(i("5c96"),a(i("56b3")));i("a7be"),i("a8d9"),i("f9d4"),i("693d");var o={name:"edittemdim",props:["nowAnalysisRegionId","nowDimAnalysisRegionId","dimId","dimDivId","analysisList","addTempDimAnalysisRegionId"],components:{seeSqlData:function(e){return i.e("chunk-3317cbda").then(function(){var t=[i("7adc")];e.apply(null,t)}.bind(this)).catch(i.oe)}},data:function(){return{editor:null,editData:{},form:{dimName:"",code:"",dimMemo:""},dimList:[],seeSqlDataDialog:!1,seeDataSql:""}},mounted:function(){this.initData()},created:function(){},methods:{initData:function(){var e=this;if((0,s.default)("#colName").html(""),this.dimList=JSON.parse(sessionStorage.getItem("resultObj")),s.default.each(this.dimList,(function(t,i){for(var a=(0,s.default)("<li id='"+i.inDimensionUuid+"'>"+i.dimensionName+"</li>"),n=0;n<a.length;n++)a[n].onclick=e.setStyle,a[n].ondragstart=e.ulDragStart,a[n].draggable=!0,a[n].ondragend=e.ulDragEnd;(0,s.default)("#colName").append(a)})),this.editor=n.default.fromTextArea(document.getElementById("code"),{lineNumbers:!0,indentUnit:4,styleActiveLine:!0,matchBrackets:!0,mode:"htmlmixed",lineWrapping:!0}),null!=this.dimId){var t=JSON.parse(sessionStorage.getItem("temDimObj"));this.editData=t,(0,s.default)("#dimName").attr("value",t.dimensionName),(0,s.default)("#dimMemo").text(t.dimMemo),this.setValue2CM(this.editor,t.columnName)}},setValue2CM:function(e,t){var i=0,a="",s=0;while(i<t.length)"["==t[i]?(i+=1,this.appendValue2CM(this.editor,a,s),a="",s=1):"]"==t[i]?(i+=1,this.appendValue2CM(this.editor,a,s),a="",s=0):a+=t[i++];this.appendValue2CM(this.editor,a,0)},appendValue2CM:function(e,t,i){var a,n=this,o=this.editor.getCursor({line:this.editor.lineCount(),ch:99999});if(1==i)if(this.editor.replaceRange("["+t+"]",o,o),s.default.each(this.dimList,(function(e,i){t==i.inDimensionUuid&&(a=i.dimensionName)})),void 0==a)n.editor.replaceRange(t,o,o);else{var l=(0,s.default)("<span class='selected' id='["+t+"]'>"+a+"</span>").get(0),d=n.editor.getCursor({line:n.editor.lineCount(),ch:99999});n.editor.markText(o,d,{replacedWith:l,className:"selected"})}else n.editor.replaceRange(t,o,o)},setStyle:function(){(0,s.default)("#colName li").removeClass(),(0,s.default)(this).addClass("selected")},ulDragStart:function(){},ulDragEnd:function(e){var t=e.target.id,i=e.target.textContent;this.addStyle(t,i)},addStyle:function(e,t){e="["+e+"]";var i=(0,s.default)("<span class ='selected' id ='"+e+"'>"+t+"</span>").get(0),a=this.editor.getCursor(),n={ch:a.ch+e.length,line:a.line,sticky:null};this.editor.replaceRange(e,a,a),this.editor.markText(a,n,{replacedWith:i,className:"selected"})},closeDialog:function(){this.$emit("closeEdittemdimDialog")},seeSqlData:function(){var e,t=this,i=this.form.dimName,a=this.editor.getValue(),n=this.getuuid(),o={dimensionName:this.form.dimName,columnName:a,dimMemo:this.form.dimMemo,filterType:"",values:[],id:n,custom:this.form.dimName,filter:"",filterJson:"",yesNolevel:!1,level:0,yesNoTem:!0,dimAnalysisRegionId:this.nowDimAnalysisRegionId,analysisRegionId:this.nowAnalysisRegionId},l=[];l.push(o),s.default.each(this.analysisList,(function(i,a){null!=a&&a.id==t.addTempDimAnalysisRegionId&&(e=a.objInList)}));var d=this.contextUrl+"/indicatrixAnalysis/getColData";s.default.post(d,{inMeasures:JSON.stringify(e),listDim:JSON.stringify(l),dimId:n,columnName:i},(function(e){e.isError?t.$message({type:"info",message:e.message}):(t.seeDataSql=e.sql,t.seeSqlDataDialog=!0)}),"json")},saveTemDim:function(){var e=(0,s.default)("#dimName").val(),t=(0,s.default)("#dimMemo").val(),i=this.editor.getValue();if(this.ver(e,t,i)){var a=this.$emit("verTemDimName",this.nowAnalysisRegionId,e),n=this.$emit("getInDimList");if(null==this.editData){if(!a)return void this.$message("名称重复！");for(var o=0;o<n.length;o++)if(e==n[o])return void this.$message("名称重复！")}else if(e!=this.editData.dimensionName&&!a)return void this.$message("名称重复！");null!=this.dimId?this.update(e,t,i):this.save(e,t,i),this.closeDialog()}},save:function(e,t,i){var a=this.getuuid(),s={dimensionName:e,columnName:i,dimMemo:t,filterType:"",values:[],id:a,custom:"",filter:"",filterJson:"",yesNolevel:!1,level:0,yesNoTem:!0,dimAnalysisRegionId:this.nowDimAnalysisRegionId,analysisRegionId:this.nowAnalysisRegionId};this.$emit("initTemDimToFrom",s)},update:function(e,t,i){this.editData.dimensionName=e,this.editData.dimMemo=t,this.editData.columnName=i;var a=this.editData.analysisRegionId,s=this.editData.id;this.$emit("delTemDim",a,s,this.dimDivId,"true"),this.$emit("initTemDimToFrom",this.editData)},ver:function(e,t,i){return 0==e.length?(this.$message("名称不能为空！"),!1):e.length>50?(this.$message("名称不能大于50个字符！"),!1):0==i.length?(this.$message("sql不能为空！"),!1):!(t.length>2e3)||(this.$message("说明不能大于2000个字符！"),!1)}}};t.default=o},2859:function(e,t,i){"use strict";i.r(t);var a=i("21ea"),s=i.n(a);for(var n in a)["default"].indexOf(n)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(n);t["default"]=s.a},"4f37":function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return s}));var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-container",[i("el-aside",[i("ul",{attrs:{id:"colName"}})]),i("el-container",[i("el-main",[i("el-form",[i("el-form-item",{attrs:{label:"维度名称"}},[i("el-input",{attrs:{id:"dimName"},model:{value:e.form.dimName,callback:function(t){e.$set(e.form,"dimName",t)},expression:"form.dimName"}})],1),i("el-form-item",{attrs:{label:"SQL"}},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:e.form.code,expression:"form.code"}],attrs:{id:"code",name:"code"},domProps:{value:e.form.code},on:{input:function(t){t.target.composing||e.$set(e.form,"code",t.target.value)}}})]),i("el-form-item",{attrs:{label:"维度说明"}},[i("el-input",{attrs:{type:"textarea",id:"dimMemo"},model:{value:e.form.dimMemo,callback:function(t){e.$set(e.form,"dimMemo",t)},expression:"form.dimMemo"}})],1)],1)],1),i("el-footer",[i("div",{staticStyle:{float:"right"}},[i("el-button",{attrs:{type:"primary"},on:{click:e.seeSqlData}},[e._v("查看结果")]),i("el-button",{attrs:{type:"primary"},on:{click:e.saveTemDim}},[e._v("保存")]),i("el-button",{attrs:{type:"primary"},on:{click:e.closeDialog}},[e._v("取消")])],1)])],1),e.seeSqlDataDialog?i("el-dialog",{attrs:{"append-to-body":"",title:"查看数据",visible:e.seeSqlDataDialog},on:{"update:visible":function(t){e.seeSqlDataDialog=t}}},[i("seeSqlData",{attrs:{seeDataSql:e.seeDataSql}})],1):e._e()],1)},s=[]},6668:function(e,t,i){}}]);